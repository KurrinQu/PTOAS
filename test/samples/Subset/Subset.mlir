module {
  func.func @test_double_buffer_step(%arg0: memref<32x32xf32, strided<[?, 1], offset: ?>, #pto.address_space<gm>>, %arg1: memref<32x32xf32, strided<[?, 1], offset: ?>, #pto.address_space<gm>>, %arg2: !pto.tile_buf<32x64xf32, #pto.address_space<ub>>) {
    %c0 = arith.constant 0 : index
    %c32 = arith.constant 32 : index
    %0 = pto.subset %arg2[%c0, %c0] sizes [32, 32] : <32x64xf32, #pto.address_space<ub>>
    %1 = pto.subset %arg2[%c0, %c32] sizes [32, 32] : <32x64xf32, #pto.address_space<ub>>
    pto.tadd ins(%0, %0 : !pto.tile_buf<32x32xf32, strided<[32, 1], offset: [?, ?]>, #pto.address_space<ub>>, !pto.tile_buf<32x32xf32, strided<[32, 1], offset: [?, ?]>, #pto.address_space<ub>>) outs(%0 : !pto.tile_buf<32x32xf32, strided<[32, 1], offset: [?, ?]>, #pto.address_space<ub>>)
    pto.tload ins(%arg0 : memref<32x32xf32, strided<[?, 1], offset: ?>, #pto.address_space<gm>>) outs(%1 : !pto.tile_buf<32x32xf32, strided<[32, 1], offset: [?, ?]>, #pto.address_space<ub>>)
    pto.tstore ins(%0 : !pto.tile_buf<32x32xf32, strided<[32, 1], offset: [?, ?]>, #pto.address_space<ub>>) outs(%arg1 : memref<32x32xf32, strided<[?, 1], offset: ?>, #pto.address_space<gm>>)
    return
  }
}
